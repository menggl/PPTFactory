# 大纲目录生成工具使用说明

## 功能说明

根据 `requirement.txt` 中的原始文本内容，生成结构化的PPT大纲目录，保存到 `大纲目录.txt` 文件中。

## 使用方法

### 方式1: 手动生成（基于规则，默认）

```bash
cd /Users/menggl/workspace/PPTFactory
python3 python/generate_outline.py
```

这种方式会根据文本结构自动识别主标题和子标题，生成大纲目录。

### 方式2: 使用OpenAI API生成（推荐，更准确）

```bash
# 设置API密钥
export OPENAI_API_KEY="your-api-key-here"

# 运行脚本
cd /Users/menggl/workspace/PPTFactory
python3 python/generate_outline.py --use-api
```

或者直接在命令行指定API密钥：

```bash
python3 python/generate_outline.py --use-api --api-key "your-api-key-here"
```

### 使用其他模型

```bash
# 使用gpt-3.5-turbo（更便宜）
python3 python/generate_outline.py --use-api --model "gpt-3.5-turbo"

# 使用gpt-4（更高质量）
python3 python/generate_outline.py --use-api --model "gpt-4"
```

## 功能特点

1. **自动识别结构**: 自动识别主标题（一、二、三...）和子标题
2. **支持提示词模板**: 如果存在 `生成大纲目录提示词.txt` 文件，会使用该文件作为提示词模板
3. **智能提取**: 手动模式会智能识别子标题（基于行长度、关键词、上下文等）
4. **API增强**: 使用API生成可以获得更准确、更完整的大纲目录

## 输入文件

- **requirement.txt**: 必须包含原始文本内容
- **生成大纲目录提示词.txt**: 可选，如果存在会作为API调用的提示词模板

## 输出结果

生成的大纲目录保存在 `produce/大纲目录.txt` 文件中，格式如下：

```
标题名称

一、第一章标题
1. 子标题1
2. 子标题2
3. 子标题3

二、第二章标题
1. 子标题1
2. 子标题2

三、第三章标题
1. 子标题1
2. 子标题2
3. 子标题3

四、总结
```

## 生成规则

### 手动生成模式

1. **主标题识别**: 识别以"一、二、三..."开头的行作为主标题
2. **子标题识别**: 
   - 识别以数字序号开头的行（如"1. xxx"）
   - 识别短行（<30字）且不包含句号的行
   - 检查下一行是否是详细内容（包含句号或较长）
   - 检查是否包含常见关键词（权、义务、案例等）
3. **自动编号**: 为子标题自动添加序号

### API生成模式

使用OpenAI API生成更专业、更完整的大纲目录，会考虑：
- 文本的整体结构
- 内容的逻辑关系
- PPT演示的最佳实践
- 提示词模板的要求（如果提供）

## 注意事项

1. **API使用**: 使用OpenAI API需要安装 `openai` 库：
   ```bash
   pip install openai
   ```

2. **API密钥**: 确保设置了正确的API密钥，否则会回退到手动生成模式

3. **文件格式**: 确保 `requirement.txt` 文件格式正确，主标题使用"一、二、三..."格式

4. **提示词模板**: 如果提供了 `生成大纲目录提示词.txt` 文件，API模式会使用该文件作为系统提示词

## 示例

### 输入（requirement.txt）

```
煤矿开采岗位安全操作与法律法规精炼文本
一、煤矿从业人员主要权利

健康保障权
司机若确诊尘肺病，企业需提供治疗和康复服务。离职时可索要历年体检报告，企业不得拒绝。

拒绝违章指挥权
从业人员有权拒绝违反安全规程的指令...
```

### 输出（大纲目录.txt）

```
煤矿开采岗位安全操作与法律法规精炼文本

一、煤矿从业人员主要权利
1. 健康保障权
2. 拒绝违章指挥权
3. 停止作业避险权
4. 工伤保险与民事赔偿权
5. 批评、检举和控告权

二、采煤机司机主要义务
1. 遵守安全规章和操作规程
2. 服从安全生产管理
3. 正确佩戴和使用劳动防护用品
4. 发现事故隐患及时报告并参与抢险
5. 接受安全生产培训教育
6. 改善工作环境和爱护设备

三、案例分析与思政要点
1. 瓦斯超限停机案例
2. 忽视隐患导致事故案例
3. 多岗位协同避险案例

四、总结
```

## 故障排除

1. **找不到子标题**: 确保文本格式正确，子标题应该是短行且不包含句号
2. **API调用失败**: 检查API密钥是否正确，网络是否正常
3. **文件读取错误**: 确保所有输入文件都存在且格式正确








