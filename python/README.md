# Python 脚本目录

本目录包含用于PPT内容处理的Python工具脚本。

## 脚本列表

### generate_ppt_content_mapping.py

生成PPT内容映射脚本，用于将PPT内容页信息转换为模板页的文本映射关系。

#### 功能说明

- 读取 `produce/ppt内容页.txt` 中的内容页信息
- 根据模板类型（T001-T012）生成对应的文本映射关系
- 输出映射文件到 `produce/ppt内容映射.txt`

#### 映射规则

1. **待替换文本键名**：不包含【】符号，如 `"一我是主标题"` 而不是 `"【一我是主标题】"`
2. **容错处理**：每个文本位置都同时提供"文本"和"长文本"两种映射关系
   - 例如：`"三我是文本"` 和 `"三我是长文本"` 都存在
3. **模板页编号**：包含模板页编号（T001, T002, T003等）

#### 使用方法

```bash
# 在项目根目录下运行
python3 python/generate_ppt_content_mapping.py
```

#### 输入文件

- `produce/ppt内容页.txt`：PPT内容页信息（JSON格式，多个对象）

#### 输出文件

- `produce/ppt内容映射.txt`：文本映射关系（JSON格式）

#### 输出格式示例

```json
[
  {
    "模板页编号": "T001",
    "文本映射": {
      "一我是主标题": "一、煤矿从业人员主要权利",
      "三我是文本": "健康保障权",
      "三我是长文本": "健康保障权",
      "四我是文本": "拒绝违章指挥权",
      "四我是长文本": "拒绝违章指挥权",
      "五我是文本": "停止作业避险权",
      "五我是长文本": "停止作业避险权"
    }
  }
]
```

#### 支持的模板类型

- **T001**: 三要点卡片（3个caption）
- **T002**: 双图标段落（2组 heading + body）
- **T003**: 左图右文（2组 heading + body）
- **T004**: 双图标段落（2组 heading + body）
- **T005**: 双图文配对（2组 heading + paragraph）
- **T007**: 多文本+单图（2-3组 heading + paragraph）
- **T009**: 双卡片（2组 heading + body）
- **T011**: 横幅图+单文本（1个 heading + 1个 body）
- **T012**: 标题+段落+图（1个 heading + 1个 body）

#### 依赖

- Python 3.6+
- 标准库：json, os, sys
