重新读取并理解ppt模板页的meta信息（/Users/menggl/workspace/PPTFactory/templates/type_purchase/pages/模板_master_template.json），优化下《produce/生成ppt_slide内容页的提示词.txt》这个文件中的【内容要求】和【排版建议】和【输出示例】

deepseek api key: sk-9d81ddfc62f94da2bb5193c67fa50a1f

（手动生成大纲目录）
根据《produce/requirement.txt》中的原始文本内容，结合《生成大纲目录提示词.txt》的要求，生成PPT大纲目录，保存在《大纲目录.txt》文件中
注意：不要通过python代码调用open api的接口实现，要手动实现


（手动生成排版内容）
根据《produce/requirement.txt》中的原始文本内容和《大纲目录.txt》中的大纲目录内容，结合《生成ppt_slide内容页的提示词.txt》的要求（注意查看需求变更），生成ppt内容页信息列表
生成结果一定要保存在《ppt内容页.txt》文件中
注意：不要通过python代码调用open api的接口实现，要手动实现


(调用代码生成映射关系，模板文本==>替换文本)
我想将《ppt内容页.txt》中生成的ppt页的内容与要替换的《ppt模板页》中的内容做替换，《ppt模板页》中的待替换文本为：
1.【一我是主标题】
2.【二我是副标题】
3.【三我是文本】或者【三我是长文本】
4.【四我是文本】或者【四我是长文本】
5.【五我是文本】或者【五我是长文本】
6.【六我是文本】或者【六我是长文本】
7.【七我是文本】或者【七我是长文本】
8.【八我是文本】或者【八我是长文本】
9.【九我是文本】或者【九我是长文本】
10.【十我是文本】或者【十我是长文本】
【待替换文本值】就是上面的十条，每个页面待替换文本的数量不一样，《ppt内容页.txt》中的【替换文本】按照顺序依次替换《ppt模板页》中的【待替换文本】，返回一个json结构的信息，
json中需要包含模板页的编号[T001][T002][T003]、【待替换文本】->【替换文本】的映射关系（长文本、短文本都要有映射，容错），json结果保存在《ppt内容映射.txt》文件中
（执行脚本pptfactory/python/generate_ppt_content_mapping.py）
cd /Users/menggl/workspace/PPTFactory
python3 python/generate_ppt_content_mapping.py



（调用代码，拷贝模板）
解析**pptfactory/produce/ppt内容映射.txt**文件，根据里面的模板页编号找到**pptfactory/templates/metadata**目录下面的模板元信息文件，找到元信息文件中的page_index值**"page_index": 1**，根据page_index编号从模板**pptfactory/templates/master_template.pptx**拷贝到新创建的pptx文件（新创建的pptx文件保存到pptfactory/produce目录下面，新创建的pptx文件命名规则为new_ppt_[年月日时分秒].pptx）
比如**ppt内容映射.txt**文件中有这个数据**"模板页编号": "T001",**，那就找到**T001.json**，而**T001.json**中有这个数据**"page_index": 1,**，那就将**pptfactory/templates/master_template.pptx**的第1页模板拷贝到新pptx文件中，要按照**ppt内容映射.txt**映射顺序进行拷贝
拷贝模板代码参考pptfactory/src/main/java/com/pptfactory/util/CopyPPTSlideUtil.java的实现（aspose工具），然后将里面的水印清除，水印清除代码参考pptfactory/src/main/java/com/pptfactory/util/CleanWatermarksUtil.java的实现，然后调用pptfactory/src/main/java/com/pptfactory/util/CleanAllNoteTextUtil.java里面的代码清除note信息，所有的代码实现保存在pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java文件中
（可以直接调用**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**的main方法）


（调用代码，替换文本）
根据**pptfactory/produce/ppt内容映射.txt**文件中的文本替换映射关系，将**新生成的pptx**文件中的**待替换文本**，替换为映射关系中的**替换文本**
比如：**pptfactory/produce/ppt内容映射.txt**文件中的这个配置：
**
  {
    "模板页编号": "T001",
    "文本映射": {
      "一我是主标题": "一、煤矿从业人员主要权利",
      "三我是文本": "工伤保险与民事赔偿权",
      "三我是长文本": "工伤保险与民事赔偿权",
      "四我是文本": "批评、检举和控告权",
      "四我是长文本": "批评、检举和控告权",
      "五我是文本": "权利保护=安全保障",
      "五我是长文本": "权利保护=安全保障"
    }
  }
**
是json中的第2条配置，那就找到**新生成的pptx**文件中的第2页，将**待替换文本**替换成**替换文本**（一我是主标题 替换为 一、煤矿从业人员主要权利），替换代码逻辑参考**pptfactory/src/main/java/com/pptfactory/util/ReplacePPTTextUtil**中的替换逻辑，但是不要用这个类，在**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**类中实现替换方法
（可以直接调用**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**的main方法）


-------上面是文本处理，下面是图片处理------------


------------**图片提示词准备**内容生成开始------------------
（调用代码，待替换文本===>图片提示词准备）
------生成**图片提示词准备**开始-----
---------**第1步，标注内容** 转换成 **替换内容** 开始---------
遍历新生成好的pptx文件**pptfactory/produce/new_ppt_[年月日时分秒].pptx**的每一页内容（使用POI工具），查找每个ppt页中**图片**的**对象属性->大小与属性->可选文字->标题**标注的内容（比如：三我是文本|四我是长文本）
拆分上一步拿到的标注内容（标注内容是用|拼接的，根据|分隔符进行拆分，比如:标注内容为“三我是文本|四我是长文本”，拆分出来后就是两项（三我是文本、四我是长文本））
拿到**pptfactory/produce/ppt内容映射.txt**文件中的**待替换文本**与**替换文本**的映射关系，拿着拆分后的**标注内容**匹配**待替换文本**，进而找到**替换文本**内容，将所有映射到的**替换文本**进行内容拼接（也是用|进行拼接）；
标注内容中除了**一我是主标题**、**二我是副标题**、**四我是文本**这种，还有一些**其它内容**，比如[“圆形图片”、“矩形图片”、”线条图标“]，这些**其它内容**映射不到**替换文本**，保留这些**其它内容**，将这些**其它内容**拼接到**替换文本**的最后面
---------**第1步，标注内容** 转换成 **替换内容** 结束---------
---------**第2步，图片大小** 解析开始 ----------------------
在第1步中，除了拿到图片的**标注内容**，还需要拿到**图片**的**对象属性->大小与属性->大小->高度和宽度值（比如高度4.80厘米，宽度4.80厘米）拿到高度和宽度的数值后，将高度和宽度乘以120dpi，得到图片分辨率，然后得到**图片大小**信息：“图片尺寸为**宽度值**像素宽 × **高度值**像素高”
---------**第2步，图片大小** 解析结束 ----------------------
------生成**图片提示词准备**结束-----  
------保存**图片提示词准备**内容到映射文件开始----
在**pptfactory/produce/ppt内容映射.txt**文件中保存一项新内容：**图片提示词准备**，里面保存着第1步生成的内容（**替换内容**集合+标注的**其他内容**）和第2步生成内容（图片大小）
------保存**图片提示词准备**内容到映射文件结束----
------示例开始------
比如：**pptfactory/produce/new_ppt_[年月日时分秒].pptx**中有一张图片的标注内容是：三我是文本|四我是长文本|极简线条，图片大小属性为：高度4.80厘米，宽度5.80厘米，而对应页面中该**文本映射**关系为：
      "一我是主标题": "二、采煤机司机主要义务",
      "二我是副标题": "1. 遵守安全规章和操作规程",
      "三我是文本": "作业前检查与规范启动",
      "三我是长文本": "作业前检查与规范启动",
      "四我是文本": "严格执行《煤矿安全规程》和采煤机操作规范，包括检查截齿、隔离开关、电缆、喷雾、瓦斯浓度等关键部件，确认合格再作业，减少设备和人员风险。开机前必须完成设备检查和环境检查，确保设备状态良好。",
      "四我是长文本": "严格执行《煤矿安全规程》和采煤机操作规范，包括检查截齿、隔离开关、电缆、喷雾、瓦斯浓度等关键部件，确认合格再作业，减少设备和人员风险。开机前必须完成设备检查和环境检查，确保设备状态良好。",
      "五我是文本": "停机断电，严禁习惯性违章",
      "五我是长文本": "停机断电，严禁习惯性违章",
      "六我是文本": "操作结束后必须断电，按规程操作，避免因省略步骤造成设备损坏或人身伤害。严禁省略安全步骤，杜绝习惯性违章操作，保障作业安全。",
      "六我是长文本": "操作结束后必须断电，按规程操作，避免因省略步骤造成设备损坏或人身伤害。严禁省略安全步骤，杜绝习惯性违章操作，保障作业安全。"
那增加的**图片提示词准备**就是
三我是文本|四我是长文本|极简线条 => 作业前检查与规范启动|严格执行《煤矿安全规程》和采煤机操作规范，包括检查截齿、隔离开关、电缆、喷雾、瓦斯浓度等关键部件，确认合格再作业，减少设备和人员风险。开机前必须完成设备检查和环境检查，确保设备状态良好。|极简线条|图片尺寸为像素696宽 × 576像素高
------示例结束------
------注意事项开始------
解析新生成好的pptx文件**pptfactory/produce/new_ppt_[年月日时分秒].pptx**中图片标注内容和图片属性内容，可以参考**pptfactory/src/main/java/com/pptfactory/util/ReplacePPTImageUtil.java**中的代码逻辑，该功能最终实现代码保存在**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**类中
这一步先不要生成图片提示词，生成图片提示词是下一步的工作
------注意事项结束------
（可以直接调用**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**的main方法）
------------**图片提示词准备**内容生成结束------------------


-------------生成**图片提示词**并**生成图片**开始------------------
通过java调用coze工作流生成图片，返回图片链接
根据**pptfactory/produce/ppt内容映射.txt**文件上一步生成好的**图片提示词准备**内容，调用coze工作流生成图片，coze工作流将返回生成好的图片链接，将图片链接保存到**pptfactory/produce/ppt内容映射.txt**文件中，
新增一个**图片链接映射**字段，保存**图片标注**与**图片链接的关联关系
创建一个新的java工具类，在src/main/java/com/pptfactory/util目录下面，实现这个功能
-------------生成**图片提示词**并**生成图片**结束------------------


（大模型手动实现，待替换文本===>图片文件地址）
解析**ppt内容映射.txt**文件，将**图片链接映射**里面的图片从图片url处下载下来，下载下来的图片保存在**pptfactory/produce/images/new_ppt_[年月日时分秒]**目录下面，文件夹名称和生成的ppt文件名相同，生成的图片命名格式：**[第几页]_[第几张图片].png**
**pptfactory/produce/ppt内容映射.txt**文件中再增加一个key：**图片路径映射**，保存**图片标注**与**新生成的图片文件路径**之间的关联关系
该功能在**src/main/java/com/pptfactory/util**目录下新建一个java类来实现



解析**ppt内容映射.txt**文件，拿到里面的**图片路径映射**，遍历生成的**pptfactory/produce/new_ppt_[年月日时分秒].pptx**中的每一页ppt，找到有**图片标注**的图片，用**图片路径映射**中的key（图片标注）匹配，匹配成功后将value（图片路径）的图片替换上去
该功能在**src/main/java/com/pptfactory/util**目录下新建一个java类来实现，可以参考ReplacePPTImageUtil.java中的代码实现逻辑


在这个目录（/Users/menggl/workspace/PPTFactory/src/main/java/com/pptfactory/util）中新建一个java类，用于解析**提供的pptx**中每页ppt里保存的**备注**信息
**备注**信息是该ppt页json格式的metadata数据（包括排版布局，适合什么场景使用），将该**备注**信息提取出来，保存成json文件（json文件名为T001.json,T002.json，Txxx中的xxx就是该metadata的json从第几页ppt拿取出来的编号）
json文件中的**"template_id": "T002"**字段值为该json的文件名（比如T003.json中的template_id值就是T003）,json文件中的**"page_index": 2**值表示模板第几页，跟json文件名中的数字保持一致（比如T009.json中page_index值就为9）
将保存好的json文件保存到与该模板pptx目录相同的metadata文件夹中，没有metadata文件夹就新建一个（比如提供的pptx路径是：/Users/menggl/workspace/PPTFactory/templates/type_purchase/master_template.pptx，那就需要创建一个/Users/menggl/workspace/PPTFactory/templates/type_purchase/metadata文件夹）
请将/Users/menggl/workspace/PPTFactory/templates/type_purchase/master_template.pptx文件中的备注信息中的metadata信息提取到对应json文件中