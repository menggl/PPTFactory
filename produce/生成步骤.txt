重新读取并理解ppt模板页的meta信息（templates/metadata/T_xxx.json），优化下《produce/生成ppt_slide内容页的提示词.txt》这个文件中的【内容要求】和【排版建议】和【输出示例】


（手动生成大纲目录）
根据《produce/requirement.txt》中的原始文本内容，结合《生成大纲目录提示词.txt》的要求，生成大纲目录，保存在《大纲目录.txt》文件中

（手动生成排版内容）
根据《produce/requirement.txt》中的原始文本内容和《大纲目录.txt》中的大纲目录内容，结合《生成ppt_slide内容页的提示词.txt》的要求（注意查看需求变更），生成ppt内容页信息列表，保存在《ppt内容页.txt》文件中


(调用代码生成映射关系，模板文本==>替换文本)
我想将《ppt内容页.txt》中生成的ppt页的内容与要替换的《ppt模板页》中的内容做替换，《ppt模板页》中的待替换文本为：
1.【一我是主标题】
2.【二我是副标题】
3.【三我是文本】或者【三我是长文本】
4.【四我是文本】或者【四我是长文本】
5.【五我是文本】或者【五我是长文本】
6.【六我是文本】或者【六我是长文本】
7.【七我是文本】或者【七我是长文本】
8.【八我是文本】或者【八我是长文本】
9.【九我是文本】或者【九我是长文本】
10.【十我是文本】或者【十我是长文本】
【待替换文本值】就是上面的十条，每个页面待替换文本的数量不一样，《ppt内容页.txt》中的【替换文本】按照顺序依次替换《ppt模板页》中的【待替换文本】，返回一个json结构的信息，
json中需要包含模板页的编号[T001][T002][T003]、【待替换文本】->【替换文本】的映射关系（长文本、短文本都要有映射，容错），json结果保存在《ppt内容映射.txt》文件中
（执行脚本pptfactory/python/generate_ppt_content_mapping.py）



（调用代码，拷贝模板）
解析**pptfactory/produce/ppt内容映射.txt**文件，根据里面的模板页编号找到**pptfactory/templates/metadata**目录下面的模板元信息文件，找到元信息文件中的page_index值**"page_index": 1**，根据page_index编号从模板**pptfactory/templates/master_template.pptx**拷贝到新创建的pptx文件（新创建的pptx文件保存到pptfactory/produce目录下面，新创建的pptx文件命名规则为new_ppt_[年月日时分秒].pptx）
比如**ppt内容映射.txt**文件中有这个数据**"模板页编号": "T001",**，那就找到**T001.json**，而**T001.json**中有这个数据**"page_index": 1,**，那就将**pptfactory/templates/master_template.pptx**的第1页模板拷贝到新pptx文件中，要按照**ppt内容映射.txt**映射顺序进行拷贝
拷贝模板代码参考pptfactory/src/main/java/com/pptfactory/util/CopyPPTSlideUtil.java的实现（aspose工具），然后将里面的水印清除，水印清除代码参考pptfactory/src/main/java/com/pptfactory/util/CleanWatermarksUtil.java的实现，然后调用pptfactory/src/main/java/com/pptfactory/util/CleanAllNoteTextUtil.java里面的代码清除note信息，所有的代码实现保存在pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java文件中
（可以直接调用**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**的main方法）


（调用代码，替换文本）
根据**pptfactory/produce/ppt内容映射.txt**文件中的文本替换映射关系，将**新生成的pptx**文件中的**待替换文本**，替换为映射关系中的**替换文本**
比如：**pptfactory/produce/ppt内容映射.txt**文件中的这个配置：
**
  {
    "模板页编号": "T001",
    "文本映射": {
      "一我是主标题": "一、煤矿从业人员主要权利",
      "三我是文本": "工伤保险与民事赔偿权",
      "三我是长文本": "工伤保险与民事赔偿权",
      "四我是文本": "批评、检举和控告权",
      "四我是长文本": "批评、检举和控告权",
      "五我是文本": "权利保护=安全保障",
      "五我是长文本": "权利保护=安全保障"
    }
  }
**
是json中的第2条配置，那就找到**新生成的pptx**文件中的第2页，将**待替换文本**替换成**替换文本**（一我是主标题 替换为 一、煤矿从业人员主要权利），替换代码逻辑参考**pptfactory/src/main/java/com/pptfactory/util/ReplacePPTTextUtil**中的替换逻辑，但是不要用这个类，在**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**类中实现替换方法
（可以直接调用**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**的main方法）



（调用代码，待替换文本===>图片标注映射）
遍历新生成好的pptx文件**pptfactory/produce/new_ppt_[年月日时分秒].pptx**的每一页内容（使用POI工具），查找每个ppt页中**图片**的**对象属性->大小与属性->可选文字->标题**标注的内容（比如：三我是文本|四我是长文本）
解析**pptfactory/produce/ppt内容映射.txt**文件中**待匹配文本**与**匹配文本**的映射关系，拆分上一步拿到的标注内容（用|拆分，比如:标注内容为“三我是文本|四我是长文本”，拆分出来后就是两项（三我是文本、四我是长文本）），拿着拆分后的标注匹配**待替换文本**，进而找到**替换文本**内容，然后根据拿到的**替换文本**内容生成**图片提示词**
生成**图片提示词**之后，在**pptfactory/produce/ppt内容映射.txt**文件中保存一项新内容：**图片映射**，里面保存着**标注内容**与**图片提示词**内容的映射关系
比如：**pptfactory/produce/new_ppt_[年月日时分秒].pptx**中有一张图片的标注内容是：三我是文本|四我是长文本，而对应页面中该**文本映射**关系为：
      "一我是主标题": "二、采煤机司机主要义务",
      "二我是副标题": "1. 遵守安全规章和操作规程",
      "三我是文本": "作业前检查与规范启动",
      "三我是长文本": "作业前检查与规范启动",
      "四我是文本": "严格执行《煤矿安全规程》和采煤机操作规范，包括检查截齿、隔离开关、电缆、喷雾、瓦斯浓度等关键部件，确认合格再作业，减少设备和人员风险。开机前必须完成设备检查和环境检查，确保设备状态良好。",
      "四我是长文本": "严格执行《煤矿安全规程》和采煤机操作规范，包括检查截齿、隔离开关、电缆、喷雾、瓦斯浓度等关键部件，确认合格再作业，减少设备和人员风险。开机前必须完成设备检查和环境检查，确保设备状态良好。",
      "五我是文本": "停机断电，严禁习惯性违章",
      "五我是长文本": "停机断电，严禁习惯性违章",
      "六我是文本": "操作结束后必须断电，按规程操作，避免因省略步骤造成设备损坏或人身伤害。严禁省略安全步骤，杜绝习惯性违章操作，保障作业安全。",
      "六我是长文本": "操作结束后必须断电，按规程操作，避免因省略步骤造成设备损坏或人身伤害。严禁省略安全步骤，杜绝习惯性违章操作，保障作业安全。"
那增加的**图片映射关系**就是
三我是文本|四我是长文本 => 作业前检查与规范启动|严格执行《煤矿安全规程》和采煤机操作规范，包括检查截齿、隔离开关、电缆、喷雾、瓦斯浓度等关键部件，确认合格再作业，减少设备和人员风险。开机前必须完成设备检查和环境检查，确保设备状态良好。
解析pptx中图片标注内容可以参考**pptfactory/src/main/java/com/pptfactory/util/ReplacePPTImageUtil.java**中的代码逻辑，该功能最终实现代码在**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**类中
如果图片标注中还有其它的信息，比如[“圆形图片”、“矩形图片”、”图片分辨率640x480“]，保留这些标注信息，与**替换文本**合并在一起，放到**图片映射关系**中（**待替换文本** ==> **替换文本**合并信息 + **标注的其它信息**）
（可以直接调用**pptfactory/src/main/java/com/pptfactory/util/ProduceUtil.java**的main方法）



（大模型手动实现，待替换文本===>图片提示词）
大模型手动实现下面的需求（生成图片提示词、保存映射关系）
根据**pptfactory/produce/ppt内容映射.txt**文件中**的**图片标注**与**替换文本**的映射关系内容，根据**替换文本**内容结合**大纲目录.txt**、**requirements.txt**的内容，生成**替换文本**对应的**图片提示词**，
将生成的**图片提示词**重新保存到**pptfactory/produce/ppt内容映射.txt**文件，json中新增一个key**图片提示词**，根据**图片提示词**生成的图片要适合在ppt中演示，符合ppt的展示风格



（大模型手动实现，待替换文本===>图片文件地址）
手动实现下面的需求（生成图片、保存映射关系）
根据上一步生成的**图片提示词**生成对应的图片，图片保存在**pptfactory/produce/images/new_ppt_[年月日时分秒]**目录下面，文件夹名称和生成的ppt文件名相同，生成的图片命名格式：**[第几页]_[第几张图片].png**
**pptfactory/produce/ppt内容映射.txt**文件中再增加一个key：**新图片映射**，保存**图片标注**与**新生成的图片文件路径**之间的关联关系



（代码实现，图片替换）


